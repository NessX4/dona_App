{% comment %} {% extends 'base.html' %} {% endcomment %}

{% block content %}
<div class="container mt-4">
    <h2>Crear Nueva Publicación</h2>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="card mb-4">
            <div class="card-header">Información Básica</div>
            <div class="card-body">
                {{ form.as_p }}
            </div>
        </div>
        
        <div class="card mb-4">
            <div class="card-header">Comidas</div>
            <div class="card-body">
                {{ comida_formset.management_form }}
                {% for form in comida_formset %}
                <div class="form-row mb-3 comida-form">
                    {{ form.id }}
                    <div class="col-md-3">{{ form.nombre.label_tag }} {{ form.nombre }}</div>
                    <div class="col-md-2">{{ form.cantidad.label_tag }} {{ form.cantidad }}</div>
                    <div class="col-md-2">{{ form.categoria.label_tag }} {{ form.categoria }}</div>
                    <div class="col-md-4">{{ form.ingredientes.label_tag }} {{ form.ingredientes }}</div>
                    <div class="col-md-1">{{ form.DELETE.label_tag }} {{ form.DELETE }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <div class="card mb-4">
            <div class="card-header">Archivos Adjuntos</div>
            <div class="card-body">
                {{ archivo_formset.management_form }}
                {% for form in archivo_formset %}
                <div class="form-row mb-3 archivo-form">
                    {{ form.id }}
                    <div class="col-md-6">{{ form.url.label_tag }} {{ form.url }}</div>
                    <div class="col-md-5">{{ form.tipo.label_tag }} {{ form.tipo }}</div>
                    <div class="col-md-1">{{ form.DELETE.label_tag }} {{ form.DELETE }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <button type="submit" class="btn btn-success">Guardar</button>
        <a href="{% url 'donaciones:publicacion_list' %}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}